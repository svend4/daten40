# NEXT-20 — Change Intelligence & Risk Scoring

**Block ID:** NEXT-20  
**Название:** Change Intelligence & Risk Scoring  
**Дата:** 2026-01-13  
**Статус:** draft

## 1) Назначение
Блок рассчитывает **риск изменений** (change risk) и **blast radius** (радиус влияния) для инфраструктурных/продуктовых изменений, а также объясняет **почему риск высокий** и какие шаги снижают риск.

Главная цель: превратить “сырой поток изменений” (релизы, конфиги, IAM, зависимости сервисов) в:
- понятный **risk score** (0–100)
- объяснимые причины (“какие факторы подняли риск”)
- рекомендации (“что сделать, чтобы риск снизился”)
- интеграцию с gates (NEXT-21): *блокировать/требовать approval/тесты*

## 2) Что входит (артефакты)
Обязательные:
- `README_20260113.md`
- `spec_20260113.md`
- `manifest_20260113.json`
- `checksums_20260113.json`

Опциональные (позже):
- `schema_20260113.json` (схемы RiskAssessment)
- `openapi_20260113.yaml` (API оценки/объяснений)
- `pack_files_20260113/…` (скелеты)
- `releases/NEXT-20_change_intel_risk_scoring_pack_20260113.zip` (опционально)

## 3) Входы/выходы
**Входы:**
- изменения: deployments/releases/rollbacks, config changes, IAM changes, connector changes
- топология сервисов/владельцы (service catalog/topology)
- SLO/SLA, инциденты, error budget (observability)
- комплаенс-статусы и timeline/snapshots (NEXT-19)
- evidence неизменяемых событий (NEXT-18) — для трассируемости

**Выходы:**
- RiskAssessment (score + reasons + recommendations)
- BlastRadiusGraph (что затрагивается)
- ChangeSummary (нормализованное описание изменения)
- PolicyDecision (allow / require_approval / require_tests / block)

## 4) Границы и ответственность
**Делает:**
- нормализует изменения (change normalization)
- считает риск по правилам и сигналам (rules + signals)
- строит blast radius по топологии и зависимостям
- сохраняет объяснение и ссылки на события/timeline

**Не делает:**
- не выполняет сами изменения (это release/orchestration)
- не запускает тесты (это CI/CD)
- не хранит WORM (это NEXT-18)

## 5) Зависимости
- NEXT-19 (timeline/snapshots) — контекст “что было до/после”
- NEXT-18 (WORM events) — доказуемые ссылки на изменения/события
- Service Catalog / Topology / Ownership (есть как блоки IFOS_72801… / Change Intelligence IFOS_73201…)
- Observability (SLO/incident/postmortem блоки)

## 6) UX сценарии (минимум 3)
1) **Инженер** создаёт PR/релиз — система показывает risk=82, причины (touches auth, low test coverage, past incidents), предлагает включить canary+load test.
2) **Менеджер** смотрит портфель изменений на неделю — сортировка по risk и blast radius, назначение approvers.
3) **Комплаенс** видит, что изменение затрагивает контроль “Access logging” и требует дополнительное доказательство/attestation.

## 7) Данные (кратко)
- ChangeEvent (сырой)
- ChangeSummary (canonical)
- RiskAssessment (score + reasons)
- BlastRadiusGraph (nodes/edges + owners)
- RiskPolicy (правила расчёта + пороги)

Подробности — в `spec_20260113.md`.

## 8) Безопасность и комплаенс
- аудит: все оценки и решения фиксируются (с worm_ref)
- доступ: роль-based (engineers видеть свои; admins видеть всё)
- неизменяемость: ссылки на WORM события

## 9) Наблюдаемость
- метрики: latency оценки, доля blocked, точность (позже), false positives
- алерты: деградация качества данных (топология пустая, нет owners)

## 10) План релиза
- P0: rules-based scoring + базовый blast radius
- P1: explainability (reasons) + рекомендации
- P2: обучение на исторических инцидентах (опционально)

## 11) TODO / Next
- согласовать canonical ChangeSummary
- матрица факторов риска + веса
- протокол интеграции с NEXT-21 (gates)
