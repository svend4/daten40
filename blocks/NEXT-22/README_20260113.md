# NEXT-22 — Exceptions, Waivers & Risk Acceptance

**Block ID:** NEXT-22  
**Название:** Exceptions, Waivers & Risk Acceptance  
**Дата:** 2026-01-13  
**Статус:** draft

## 1) Назначение
Блок управляет **исключениями (exceptions)**, **временными разрешениями (waivers)** и **принятием риска (risk acceptance)**, когда политики/гейты (NEXT-21) блокируют изменение, но бизнесу нужно двигаться дальше **под контролем**.

Он закрывает типовые ситуации:
- требуется “разрешить один раз” релиз в prod при высоком риске, но с компенсирующими мерами
- нужно временно отклониться от политики (например, ретеншн/логирование), пока идёт миграция
- требуется формально зафиксировать **кто** и **почему** принял риск, **на какой срок**, **какие контроли** заменяют (compensating controls)

## 2) Что входит (артефакты)
Обязательные:
- `README_20260113.md`
- `spec_20260113.md`
- `manifest_20260113.json`
- `checksums_20260113.json`

Опциональные (позже):
- `schema_20260113.json` (модель исключений, approval, scope)
- `openapi_20260113.yaml` (API исключений/waivers)
- `pack_files_20260113/…` (скелеты/код)
- `releases/NEXT-22_exceptions_waivers_risk_acceptance_pack_20260113.zip` (опционально)

## 3) Входы/выходы
**Входы:**
- `GateDecision` и причины блокировки (NEXT-21)
- `RiskAssessment` и blast radius (NEXT-20)
- snapshot/timeline refs (NEXT-19) + worm refs (NEXT-18)
- орг-структура/роли/политики (IAM, governance)
- тикеты/инциденты/планы работ (case management)

**Выходы:**
- `ExceptionGrant` (выданное исключение) с scope+expiry+условиями
- “override hints” для Gate Engine (какие правила переопределены и чем)
- audit trail: неизменяемая запись (worm_ref) + ссылки на approvals
- задачи/уведомления: напоминание о сроках, автоматическая ревалидация

## 4) Границы и ответственность
**Делает:**
- хранит жизненный цикл исключений: запрос → согласование → выдача → контроль → истечение/отзыв
- поддерживает scope: repo/commit, сервис, env, контроль, домен данных, интеграция
- поддерживает компенсирующие меры (compensating controls) как обязательные условия

**Не делает:**
- не заменяет policy packs (он “надстройка” над политикой)
- не исполняет релиз/деплой (это orchestration)
- не рассчитывает риск (это NEXT-20)

## 5) Зависимости
- NEXT-21 (gate decisions + enforcement)
- NEXT-20 (risk score + blast radius)
- NEXT-19 (snapshot/diff для “до/после”)
- NEXT-18 (WORM/auditability)
- Ticketing/Case Management, Notifications/Activity Feed (для workflow)

## 6) UX сценарии (минимум 3)
1) **Release blocked**: gate=BLOCK из-за risk=90 → команда подаёт waiver на 48 часов + canary+extra monitoring → после approval gate становится allow_with_controls.
2) **Migration**: временно отключают часть контрольных проверок на dev/stage, но требуют компенсирующий контроль (manual review + snapshot-before) до даты завершения.
3) **Audit**: аудитору показывают список активных исключений, кто одобрил, какие меры приняты и где зафиксированы доказательства.

## 7) Наблюдаемость
- метрики: active_exceptions, exceptions_expiring_7d, overrides_used_total
- алерты: истечение waiver без закрытия, обход критического контроля без компенсирующих мер

## 8) План релиза
- P0: модели данных + workflow approval + интеграция с gate (override hints)
- P1: каталоги компенсирующих мер + авто-ревалидация + отчётность
- P2: simulation/what-if + рекомендации по снижению риска вместо waiver

## 9) TODO / Next
- формализовать “policy override contract” между NEXT-22 и NEXT-21
- определить максимальные пороги для waiver (по доменам/регионам)
- сделать аудит-экспорт (пакет исключений) для auditor portal (NEXT-17)
