# Политика публикации артефактов IFOS в GitHub при проблемах с ZIP/бинарниками

## Почему ZIP может «падать» в Make.com
Когда вы пытаетесь передавать архивы (ZIP) через чат/Make.com, чаще всего проблема не в GitHub, а в **канале доставки**:
- большие Base64-пэйлоады режутся/трункаются (лимиты запроса/памяти/времени выполнения)
- Base64 портится (пробелы, переносы, data:prefix, Base64URL, паддинг)
- попытка **перезаписи** существующего пути (Contents API требует sha → 422)
- лимиты Contents API (практически безопасно использовать только для небольших файлов)

## Рекомендованная стратегия (вариант 2: append-only)
**Основной принцип:** публикуем всё в текстовых форматах, а ZIP делаем *опциональным*.

### 1) Текст — «источник истины» (всегда публикуем)
Для каждого блока публикуем минимум:
- `blocks/<BLOCK>/README_YYYYMMDD.md`
- `blocks/<BLOCK>/spec_YYYYMMDD.md` (или `design_YYYYMMDD.md`)
- `blocks/<BLOCK>/manifest_YYYYMMDD.json`
- `blocks/<BLOCK>/checksums_YYYYMMDD.json` (SHA256 для ключевых файлов)

Опционально (если есть):
- `openapi_YYYYMMDD.yaml`
- `schema_YYYYMMDD.json`
- `*.csv` (каталоги/сид-данные)
- `*.py/*.ts/*.sql` (скелеты/код)

### 2) ZIP — только если проходит по размеру/стабильности
Если ZIP небольшой и стабильно проходит:
- кладём в `releases/<BLOCK>_<slug>_YYYYMMDD.zip`
- добавляем sha256 в `checksums_YYYYMMDD.json`

Если ZIP большой или «падает»:
- **не грузим ZIP**
- публикуем **распакованную структуру** в `blocks/<BLOCK>/pack_files_YYYYMMDD/…`
- в README пишем: «ZIP можно собрать локально командой …»

### 3) Как собирать ZIP локально (чтобы не зависеть от Make)
Добавьте в репо `tools/build_pack.py` (или bash), который:
- берёт `blocks/<BLOCK>/pack_files_YYYYMMDD/`
- собирает `releases/<BLOCK>_pack_YYYYMMDD.zip`

## Пороговое правило (для автоматизации)
- если размер бинарника > ~1MB (или Base64 > ~1.4MB) → **публикуем только текст + pack_files**
- если меньше → можно пробовать `Binary Saver (Advanced)`

## Инструменты Make.com
- Текст: `8462455 GitHub: Сохранить текст`
- Бинарники: `8463093 GitHub: Binary Saver (Advanced)`
- Contents API: `8463379` использовать только для небольших файлов и только create (в варианте 2)

## Итог
Да — если с ZIP есть проблемы, **правильнее публиковать содержимое как текстовые файлы** (md/json/yaml/csv/код), а ZIP считать вторичным «релизным» артефактом.
